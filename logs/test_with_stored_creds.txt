ğŸš€ QuantumQA Framework Runner
==================================================
ğŸ“ Instruction File: Test/UI/sample_ui_test.txt
ğŸ¯ Test Type: UI
ğŸ” Credentials: logs/test_with_stored_creds_creds.yaml
ğŸŒ Browser Mode: Connect to existing
ğŸ› Debug Port: 9222
==================================================
ğŸŒ Running Vision-Enhanced UI Test
==================================================
ğŸ¤– Initializing Vision-LLM Client...
ğŸ”‘ Loading OpenAI credentials from configuration...
âœ… Loaded credentials from: quantumqa/config/credentials.yaml
ğŸ”‘ Using OpenAI API key from credentials file
âœ… Loaded OpenAI credentials: model=gpt-4o-mini
ğŸ”® VisionLLMClient initialized with model: gpt-4o-mini
âœ… Vision client initialized successfully
âœ… Loaded credentials from: /Users/gautam/Desktop/QuantumQA/logs/test_with_stored_creds_creds.yaml
ğŸ” Credential manager initialized: /Users/gautam/Desktop/QuantumQA/logs/test_with_stored_creds_creds.yaml
ğŸ¤– ElementDetector agent 'vision_detector' initialized
ğŸ“ ElementDetector agent: Registered handler for MessageType.DETECT_ELEMENT
ğŸ“ ElementDetector agent: Registered handler for MessageType.CLEAR_ELEMENT_CACHE
ğŸ”® VisionChromeEngine initialized (vision_primary=True)
ğŸš€ Initializing Vision-Enhanced Chrome Engine...
âœ… ElementDetectorAgent 'vision_detector' initialized with vision capabilities
ğŸ”— Attempting to connect to existing Chrome on port 9222...
âœ… Connected to existing Chrome browser!
ğŸ“± Found 1 existing contexts
   Context 0: 0 pages
ğŸ“± Using first context (no active pages found)
ğŸ“„ Creating new tab in existing context...
âœ… New tab created successfully
ğŸ’¡ TIP: For best results with authentication:
   1. Manually navigate to https://aihub-uat.internal.instabase.com/ in Chrome
   2. Complete login process
   3. Then re-run this test to use authenticated session
ğŸ“ Analyzing natural browser viewport...
    ğŸ“Š Current browser state:
       Viewport: 1200x839
       Window: 1200x978
       Screen: 1728x1117
       Device Pixel Ratio: 2
    âœ… Working with natural viewport: 1200x839
    ğŸ¯ Framework will adapt to these natural dimensions
âœ… Vision-Enhanced Chrome Engine initialized
ğŸ“‹ Loaded 4 instructions

ğŸ¯ Executing Test Steps with AI Vision:
============================================================
    ğŸ§¹ UIContextManager: Cleared all contexts

ğŸ“ Step 1/4: Navigate to https://google.com
  ğŸ” Parsed as: navigate -> N/A (0.00s)
  ğŸ“Š Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 25.0%
    ğŸ§­ Navigating to: https://google.com
    ğŸ“¸ Action screenshot: test_results/actions/step_1_pre_navigation_1758083571.png
    ğŸ§­ Navigating to: https://google.com
    âœ… Navigation successful
    ğŸŒ Current URL: https://www.google.com/
    ğŸ“„ Page title: Google
    â³ Waiting for page to fully load...
    â³ Waiting for navigation to complete...
    âœ… DOM content loaded
    ğŸŒ Network activity settled
    â±ï¸ Additional stability wait completed
    ğŸ“¸ Action screenshot: test_results/actions/step_1_post_navigation_1758083584.png
    âœ… Navigation successful
    ğŸŒ Current URL: https://www.google.com/
    ğŸ“„ Page title: Google
  âœ… Step 1 completed successfully (17.07s total)
  â¸ï¸ Pausing to observe step result...

ğŸ“ Step 2/4: Click on search box
  ğŸ” Parsed as: click -> search (0.00s)
  ğŸ“Š Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50.0%
    ğŸ“ Viewport Analysis:
       Viewport: 1200x839
       Window: 1200x978
       Screen: 1728x1117
       Device Pixel Ratio: 2
       Document: 1200x839
       Scroll: (0, 0)
    ğŸ“¸ Screenshot for vision analysis: test_results/vision_analysis_step_2_1758083589.png
    ğŸ§  Using intelligent detection pipeline for: 'search'
    ğŸ¤– AI normalized 'search' â†’ ['search', 'Search', 'search box', 'search field', 'find']
    ğŸ” Trying selectors for normalized term: 'search'
    ğŸ” Trying selectors for normalized term: 'Search'
    ğŸ” Trying selectors for normalized term: 'search box'
    ğŸ” Trying selectors for normalized term: 'search field'
    ğŸ” Trying selectors for normalized term: 'find'
    ğŸ‘ï¸ AI normalization + traditional failed, using vision as final fallback
    ğŸ‘ï¸ Using vision AI to detect element for: 'Find the interactive search element that can be clicked. Look for input fields, buttons, or clickable elements, NOT decorative divs or styling elements.'
    ğŸ”„ Resized image to 2048x1432 for analysis
    ğŸ”® Calling vision model (attempt 1/3)
    âœ… Vision detected: button at (360, 520) confidence=0.95
    ğŸ’¾ Cached high-confidence detection (confidence: 0.95)
    â±ï¸ Vision detection took 11.96s
    âš ï¸ Vision found non-interactive element at (360, 520) - retrying...
    ğŸ”„ Trying semantic element search first...
    âœ… Found element with semantic search: textarea[name="q"]
    âœ… Found better interactive element at (524, 391)
    ğŸ¯ Preparing to click at coordinates (524, 391)
    ğŸ–±ï¸ Clicking at vision coordinates (524, 391)
    ğŸ” Pre-click page state:
       URL: https://www.google.com/
       Title: Google
       Ready state: complete
    ğŸ¯ Element at (524, 391):
       Tag: TEXTAREA
       ID: APjFqb
       Class: gLFyf
       Type: textarea
       Name: q
       Placeholder: None
       Role: combobox
       Aria-label: Search
       Text: None
    âœ… Page confirmed ready for interaction
    âœ… Mouse click executed successfully
    ğŸ“¸ Action screenshot: test_results/actions/step_2_click_at_524_391_1758083609.png
    â³ Monitoring for page changes...
    ğŸ” Post-click page state:
       URL: https://www.google.com/
       Title: Google
    âš ï¸ No page changes detected - click might not have worked
    ğŸ“¸ Action screenshot: test_results/actions/step_2_post_click_check_at_524_391_1758083612.png
  âœ… Step 2 completed successfully (23.16s total)
  â¸ï¸ Pausing to observe step result...

ğŸ“ Step 3/4: Type hello world
  ğŸ” Parsed as: unknown -> N/A (0.01s)
  ğŸ“Š Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘] 75.0%
    â“ Unknown action type: unknown
  âŒ Step 3 failed (0.01s total)
  â¸ï¸ Pausing to observe step result...

ğŸ“ Step 4/4: Verify page loads successfully
  ğŸ” Parsed as: verify -> N/A (0.00s)
  ğŸ“Š Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100.0%
    âœ… Verifying: page_load
    ğŸ“„ Current title: 'Google'
    ğŸŒ Current URL: https://www.google.com/
    âœ… Page load check: True
  âœ… Step 4 completed successfully (0.01s total)
  â¸ï¸ Pausing to observe step result...

ğŸ Test completed in 46.26s

============================================================
ğŸ“Š VISION-ENHANCED CHROME ENGINE REPORT
============================================================
ğŸ“ˆ Overall Success Rate: 75.0% (3/4)
ğŸŒ Final URL: https://www.google.com/
ğŸ“„ Final Title: Google

ğŸ‘ï¸ Vision Detection Statistics:
  â€¢ Vision attempts: 1
  â€¢ Vision success rate: 100.0%
  â€¢ Traditional fallbacks: 0
  â€¢ Detection failures: 0
  â€¢ LLM requests: 1
  â€¢ Estimated cost: $0.3863

ğŸ¯ Visual Feedback & Stability Features:
  â€¢ âœ… Click target highlighting enabled
  â€¢ âœ… Action screenshots captured in test_results/actions/
  â€¢ âœ… Enhanced navigation stability waiting
  â€¢ âœ… Progress indicators during execution
  â€¢ âœ… Real-time page state monitoring
  â€¢ ğŸ“¸ 215 action screenshots saved
ğŸ“¸ Final screenshot: test_results/final_vision_Test_UI_sample_ui_test.png

ğŸ“Š UI Test Results:
âœ… Success Rate: 75.0% (3/4)
ğŸŒ Final URL: https://www.google.com/
ğŸ“„ Final Title: Google
ğŸ“¸ Screenshot: test_results/final_vision_Test_UI_sample_ui_test.png

ğŸ›‘ Cleaning up Vision-Enhanced Chrome Engine...
âœ… ElementDetectorAgent 'vision_detector' cleaned up
ğŸ“„ Closed test page
ğŸ”— Connected to existing browser - keeping browser instance alive
ğŸ“± Closing empty context
âœ… Vision-Enhanced Chrome Engine cleanup completed
